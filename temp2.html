<!DOCTYPE html>
<html>
  <head>
    <title>Google Sheet JSON Viewer</title>
    <style>
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th,
      td {
        border: 1px solid #888;
        padding: 8px;
      }
    </style>
  </head>
  <body>
    <h2>Data from Sheet: "availability"</h2>
    <div id="sheet-data">Loading...</div>

    <script>
      const sheetID = "1Sxrv3iIIdl_6RqAahVZBKKCA-PvzIJXIyz5fkhq0HNc";
      const sheetName = "availability";
      const query = encodeURIComponent("SELECT *");
      const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}&tq=${query}`;

      fetch(url)
        .then((response) => response.text())
        .then((data) => {
          const json = JSON.parse(data.substring(47).slice(0, -2));
          const rows = json.table.rows;
          const cols = json.table.cols;

          let html = "<table><tr>";
          cols.forEach((col) => {
            html += `<th>${col.label}</th>`;
          });
          html += "</tr>";

          rows.forEach((row) => {
            html += "<tr>";
            row.c.forEach((cell) => {
              html += `<td>${cell ? cell.v : ""}</td>`;
            });
            html += "</tr>";
          });

          html += "</table>";
          document.getElementById("sheet-data").innerHTML = html;
        })
        .catch((error) => {
          console.error("Error:", error);
          document.getElementById("sheet-data").innerText =
            "Failed to load data.";
        });
    </script>
  </body>
</html>
